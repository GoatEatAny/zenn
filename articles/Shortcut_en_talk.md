---
title: "【無料】ChatGPTとiPhoneのShortcutアプリを使って英会話ショートカットを作ってみた"
emoji: "🤖"
type: "tech"
topics: [ChatGPT,Shortcut,ショートカット,iPhone]
published: true
---

## はじめに
英会話能力を向上させたいと常々考えていますが、金銭面やオンライン/リアル英会話教室などの「生身」の見知らぬ人間と英会話するものには、気後れして手が出せていない状況です。
そこで、ChatGPTを使用して擬似英会話相手を作ろうかなと思い、いろいろ試していたところ、2023年6月8日にChatGPTアプリがiPhoneのShortcutアプリに対応したことを知り、Shortcutアプリで擬似英会話相手を作ってみました。

「まるで人間と会話しているみたいだ！」とまではいきませんが、模擬英会話をするには必要十分なものができたかなと思います。
簡単に使用開始できるので、よかったら使ってみてください！

## 作ったショートカット
以下のリンクから、ショートカットをダウンロードできます。
※このショートカットを使うには、ChatGPTアプリをインストールしておく必要があります。
https://www.icloud.com/shortcuts/305676acd2e74203a5942eef98a75100

##　ショートカットの利用方法
1. [ChatGPTアプリ](https://apps.apple.com/jp/app/chatgpt/id6448311069)をインストールし、OpenAIのアカウントを作成/ログイン
 ※すでにインストールしている場合は、最新版へバージョンアップしてください。

:::message
ChatGPTアプリをインストール/バージョンアップした直後、ChatGPTアプリをShortcutアプリから操作できないことがあります。この事象は、端末を再起動することで解消できます。
また、初めてChatGPTアプリをインストールした場合は、一度ChatGPTアプリ上で適当なメッセージを入力してください。
:::

2. [ショートカット](https://www.icloud.com/shortcuts/305676acd2e74203a5942eef98a75100)をダウンロード
3. ショートカットを実行（必要に応じて、各種アクセスを許可）
 3-1. ショートカットを実行すると、ユーザ（あなた）の英語能力レベル選択フォームが表示されます。この中から、ユーザのレベルを選択してください。
 ![image1](/images/Shortcut_en_talk/img01.PNG))
*英語能力レベル選択フォーム*

 3-2. ChatGPTアプリが開き、最初のメッセージとして、トークテーマが英語で生成され、画面上部に日本語訳が表示されます。それぞれを読み終わったら日本語訳の「完了」をタップします。
 ※トークテーマはトークのきっかけの補助のため、もし別の話がしたい場合は、その旨を後の手順でChatGPTへリクエストしてください。
 ![image2](images/Shortcut_en_talk/img02.PNG)
*トークテーマ生成の様子*

 3-3. 次に、ユーザの会話相手であるSmithがトークテーマに沿った話をしてくれます。先ほどと同様に読み終わったら「完了」をタップしてください。
 ![image3](images/Shortcut_en_talk/img03.PNG)
*Smithのメッセージ生成の様子*

 3-4. 次に、画面上部に音声入力フォームが表示されます。Smithと会話をする感覚で話した後、音声入力フォームの「停止ボタン」をタップします。
 ![image4](images/Shortcut_en_talk/img04.PNG)
*音声入力フォーム*

 3-5. すると、話した内容がChatGPTへ渡され、Smithからの返事が生成されます。日本語訳の「完了」をタップすると、再び音声入力フォームが表示されます。
 ![image5](images/Shortcut_en_talk/img05.PNG)
*Smithからの返事生成の様子*

 3-6. これを繰り返すことで、Smithと英会話をすることができます。

4. 必要に応じて、ショートカットをホーム画面に追加

## ショートカットの細かな説明
ここでは、細かなショートカットの説明をします。コマンドという言葉が出てきますが、詳しくは次の「プロンプトの説明」セクションを読んでください。

### ショートカット画面のスクショ
ショートカットのスクショが長いため、下記アコーディオン内に収納しています。
:::details ショートカットのスクショ
![image6](images()shortcut_en_talk_img08.png)
:::

### 各アクションの説明
下記番号はショートカット画面のスクショの番号に対応しています。
1. 作成したショートカット内で再度このショートカットを実行することで、ループ処理を行なっています。ここの「ショートカットからの入力」がない場合は、ループ中ではなく使い始めと判断し、英語能力レベルの質問を投げかけます。
2. 「メニューから選択」アクションを使用して、ユーザの英語能力レベルの入力処理を行なっています。選択されたメニューに応じてレベルの数値が、後の処理にあるChatGPTへ渡すプロンプトに入ります。
3. ユーザ自身のiCloud Drive上に「en_talking/theme.txt」を作成し、過去にショートカットを使用した際に生成されたテーマを過去5回分保存しています。この情報を都度読み取り、ChatGPTのプロンプトに含むことで、ChatGPTは過去5回分のテーマと重複しないように新しいテーマを生成します。
4. ChatGPTアプリを開くことで、生成されたテキストをリアルタイムで確認できるようにしています。また、後の処理で表示される日本語訳と照らし合わせらすいかなと思いこのような実装にしています。（ChatGPTアプリとShortcutアプリの連携自体はアプリを開かなくてもできます。）
5. ChatGPTへ渡すプロンプトを「テキスト」アクションに記載し、それを「Ask ChatGPT」アクションで利用します。このアクションの設定、「Start new chat」を有効にすることで、新しいchatとして会話を始めることができます。また、プロンプト内で最初に生成するテキストへの命令として、「/talk_theme」コマンドを指定しているため、トークテーマが生成されます。
6. ChatGPTが生成したテキストは「テキストを読み上げる」アクションで読み上げつつ、「テキストを翻訳」アクションで翻訳後、「結果を表示」アクションで表示します。
7. 「/smith」コマンドをChatGPTへ渡し、ユーザの会話相手Smithのメッセージを生成させます。
8. ユーザの音声データを入力し、テキストへ変換後、ChatGPTへ渡します。
9. 最後に、このショートカット自体を実行します。これにより、ループ処理され、Smithとの会話を繰り返すことができます。また、ループ時は前段の英語能力レベルの入力やテーマ生成などはスキップされます。

## プロンプトの説明
ここでは、ChatGPTへ渡すプロンプトの説明をします。
便宜上、「///」を使用してコメントを書きます。実際のショートカット内のプロンプト上にはコメントはありません。


```md
# english_talking_with_ai_apps
*Author*: GoatEatAny
*AI name*: Smith
*User name*: ///デフォルトでは空白。ユーザの名前を指定したい場合は、ここに記載する。///
*Version*: 1.0

## AI and User personal information ///ここでChatGPTとUserの情報を設定。基本的には変更する必要はない。///
### AI (Smith)
* Role: User's friend
* Age: 25
* Gender: Woman
* Lanage: English
* Birthplace: US
* character: Humorous, Expressive
* Talk Style: Friendly, Straightforward
* Situation: Daily talk in English

### User
* Lanage: English
* Birthplace: Japan
* character: Humorous, Optimistic
* Talk Style: Friendly
* Situation: Daily talk in English
* English proficiency level: ///ユーザが選択した英語能力レベルが、ショートカットの変数として入る。///

## Features　///ここで、このプロンプトで実現したい機能概要を定義。///
* Generate talk content as a user's friend.
* To make it easier for users to talk, generate examples of responses to talk content generated by AI (YOU).
* Talk content generated by AI (YOU) is converted into audio data and delivered to the user.
* Follow the "commands", "rules" and "Examples" for detailed functions of this application.

### The user's English proficiency level ///ユーザの英語能力レベルの定義。///
* Description: This is the user's English proficiency level. The lowest depth level is 1, and the highest is 5.
1/5: Basic Explorer: Learners understand basic English alphabet and can use familiar expressions for everyday needs.
2/5: Intermediate Communicator: Learners can engage in simple conversations and handle most situations in English-speaking areas.
3/5: Proficient Speaker: Learners can interact with native speakers with some fluency and understand complex texts and nuances.
4/5: Advanced User: They can express themselves in clear, structured text and are comfortable with all forms of English.
5/5: Cultural Expert: Learners understand cultural references, humor, idioms, body language, and can articulate complex English information like native speakers.

### commands ///コマンドを擬似的に作成し、それぞれの挙動を定義。///
* prefix: "/"
* talk_theme: Generates a new theme that has not been used in the "Banned Talk Themes" so far. The theme will be selected according to the user's English proficiency level to provide appropriate topics for English conversation practice.
* smith: Generate a natural, funny talk message according to "rules" based solely on Smith's perspective and personality. Messages from other characters are not included.

### rules ///このプロンプトで実現したい機能の挙動やコマンドに関する詳細ルールを定義。///
* 1. Generate a response according to the talk theme.
* 2. Strictly follow user's commands. Particularly, when given the '/talk_theme' command, respond just Today's Theme, and when given the '/smith' command, respond as if you are Smith (YOU).
* 3. Respond as if you are part of a real conversation, not a scripted dialogue.
* 4. Provide natural conversational responses to the previous messages generated by AI (YOU) or User.
* 5. Assume that AI (YOU) and User are communicating in the same digital space.
* 6. Avoid mentioning the command words in the conversation.
* 7. The generated response should be within 10 to 50 words in length.
* 8. Tailor your responses to the user's English proficiency level.
* 9. Upon receiving the "/talk_theme" command, generate a new theme that does not exist in the "Banned Talk Themes". Each theme generated is saved in "Banned Talk Themes" to ensure no duplication, and new themes should not be generated from this list.

### Banned Talk Themes 
* Description: Banned Talk Themes are themes that users have banned. This is maintained to not generate banned talk themes.
///ここに、過去5回トークテーマをショートカットの変数として入れる。///

### Example ///各コマンドの実行例。///
* Description: These are examples of response of each commands. Reference these examples to generate funny unique content.

#### /talk_theme
Today's theme is <today's theme>.

#### /smith
<generate a talk message as smith>

## init　///最初に実行するコマンドを指定。///
* /talk_theme
```

## 作ってみて
実は、このショートカットを作成する前に、ChatGPTのAPIを使用してショートカットを作成していました。APIの場合、自前でトーク履歴の管理をする必要があったり、API使用料がかかったり...と、いろいろと面倒な部分がありました。ChatGPTアプリがShortcutアプリに対応したことで、履歴管理をすべてChatGPTアプリ側ででき、且つChatGPT3.5を無料で利用できるようになり...と、APIを使用した場合と比べ、とても簡単にショートカットを作成することができました。

ショートカットの実装については、概ね簡単にできましたが、ChatGPTへ渡す「プロンプト」は想像以上に苦戦しました。いつも何気なくちょっとしたことをChatGPTに質問するのは簡単ですが、このショートカットのように、プログラム的なものを動かすとなると、期待と逸れる挙動をできるだけ抑制する必要があります。試行錯誤の結果、「このリストとの重複を避けて」のような書き方より、「このリスト上のワードは禁止」のように、何をしていいのか、何をしてはいけないのかを明確にすることが大切だと感じました。

最後に、今回作成したショートカットには、ユーザの英語能力レベルの設定やトークテーマが毎回同じになるのを予防する処理など、基本的な機能のみを搭載しています。ショートカットを使ってみて、追加してみたい機能などがあれば、ぜひコメントください。

## ChatGPTプロンプトの参考
https://github.com/JushBJJ/Mr.-Ranedeer-AI-Tutor#planning-lessons